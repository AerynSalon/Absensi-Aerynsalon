<!DOCTYPE html>
<html lang="id" class="h-full scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AerynSalon — Absensi QR</title>
  <meta name="theme-color" content="#7C3AED" />
  <!-- Tailwind Play CDN (with config override) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            brand: {
              DEFAULT: '#7C3AED',
              50: '#F5F3FF',
              100: '#EDE9FE',
              200: '#DDD6FE',
              300: '#C4B5FD',
              400: '#A78BFA',
              500: '#8B5CF6',
              600: '#7C3AED',
              700: '#6D28D9',
              800: '#5B21B6',
              900: '#4C1D95'
            }
          },
          boxShadow: {
            soft: '0 10px 30px -10px rgba(124, 58, 237, 0.25)'
          }
        }
      }
    }
  </script>
  <link rel="icon" href="/favicon.ico" />
</head>
<body class="min-h-full bg-gradient-to-b from-white to-brand-50/40 text-slate-800 antialiased selection:bg-brand-200 selection:text-brand-900">
  <!-- App Shell -->
  <header class="sticky top-0 z-30 backdrop-blur bg-white/75 border-b border-slate-200">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-3">
      <div class="flex items-center gap-3">
        <img src="/logo.png" alt="AerynSalon" class="w-9 h-9 rounded-xl ring-1 ring-brand-200/60" />
        <div>
          <h1 class="text-lg font-semibold leading-tight">AerynSalon — Absensi QR</h1>
          <p class="text-xs text-slate-500">Modern • Cepat • Sinkron ke Google Sheets</p>
        </div>
      </div>

      <div class="ml-auto flex items-center gap-2">
        <!-- Status badge updated via JS -->
        <span id="statusBadge" class="inline-flex items-center gap-1 rounded-full bg-brand-100 text-brand-800 px-3 py-1 text-xs font-medium ring-1 ring-brand-300">
          <span class="relative flex h-2 w-2">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-brand-400 opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2 w-2 bg-brand-600"></span>
          </span>
          Online
        </span>
        <button id="btnTheme" class="px-3 py-1.5 text-xs rounded-lg border border-slate-200 hover:border-brand-300 hover:text-brand-700">
          🌙 Mode
        </button>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-6 grid gap-6">
    <!-- Primary CTA / Tabs -->
    <nav class="flex flex-wrap items-center gap-2">
      <button data-tab="scan" class="tab-btn active px-4 py-2 text-sm font-medium rounded-xl bg-brand-600 text-white shadow-soft hover:bg-brand-700 transition">Scan QR</button>
      <button data-tab="generate" class="tab-btn px-4 py-2 text-sm font-medium rounded-xl border border-slate-200 hover:border-brand-300 hover:text-brand-700 transition">Generator QR</button>
      <button data-tab="admin" class="tab-btn px-4 py-2 text-sm font-medium rounded-xl border border-slate-200 hover:border-brand-300 hover:text-brand-700 transition">Admin & Rekap</button>
    </nav>

    <!-- Tab: Scan -->
    <section id="tab-scan" class="grid md:grid-cols-3 gap-6">
      <!-- Scanner Card -->
      <div class="md:col-span-2 bg-white rounded-2xl shadow-sm ring-1 ring-slate-200 overflow-hidden">
        <div class="p-4 border-b border-slate-100 flex items-center justify-between">
          <h2 class="font-semibold">Pemindaian</h2>
          <div class="flex items-center gap-2">
            <select id="cameraSelect" class="text-sm rounded-lg border-slate-200 focus:ring-brand-400 focus:border-brand-400">
              <option>Kamera belakang (default)</option>
            </select>
            <button id="toggleCamera" class="text-sm px-3 py-1.5 rounded-lg bg-slate-100 hover:bg-slate-200">Ganti</button>
          </div>
        </div>
        <div class="p-4">
          <div class="aspect-video rounded-xl overflow-hidden ring-1 ring-slate-200 bg-slate-50 grid place-items-center">
            <!-- Your <video> element for camera feed -->
            <video id="qrVideo" class="w-full h-full object-cover"></video>
            <!-- Fallback -->
            <div id="videoFallback" class="hidden text-slate-500 text-sm">Menginisialisasi kamera…</div>
          </div>

          <div class="mt-4 grid sm:grid-cols-2 gap-3">
            <button id="scanButton" class="w-full inline-flex items-center justify-center gap-2 rounded-xl bg-brand-600 text-white px-4 py-2.5 font-medium hover:bg-brand-700 focus:ring-4 focus:ring-brand-300 active:scale-[.99]">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5"><path d="M4.5 7.5A3 3 0 017.5 4.5h.75a.75.75 0 000-1.5H7.5A4.5 4.5 0 003 7.5v.75a.75.75 0 001.5 0V7.5zm10.5-3a.75.75 0 000 1.5h.75a3 3 0 013 3v.75a.75.75 0 001.5 0V7.5A4.5 4.5 0 0015.75 3h-.75zM4.5 15.75a.75.75 0 00-1.5 0v.75A4.5 4.5 0 007.5 21h.75a.75.75 0 000-1.5H7.5a3 3 0 01-3-3v-.75zm16.5-.75a.75.75 0 00-1.5 0v.75a3 3 0 01-3 3h-.75a.75.75 0 000 1.5h.75A4.5 4.5 0 0021 15.75v-.75z"/></svg>
              Mulai Scan
            </button>
            <button id="sendNow" class="w-full rounded-xl border border-slate-200 px-4 py-2.5 font-medium hover:border-brand-300 hover:text-brand-700">Kirim Sekarang</button>
          </div>

          <p id="scanResult" class="mt-3 text-sm text-slate-600">Hasil terakhir: <span class="font-semibold">—</span></p>
        </div>
      </div>

      <!-- Info / Keterangan Card -->
      <div class="bg-white rounded-2xl shadow-sm ring-1 ring-slate-200 overflow-hidden">
        <div class="p-4 border-b border-slate-100">
          <h3 class="font-semibold">Keterangan</h3>
        </div>
        <div class="p-4 grid gap-3 text-sm">
          <div class="flex items-center justify-between">
            <span class="text-slate-600">Jam Online</span>
            <span id="clock" class="font-semibold text-brand-700">—:—:—</span>
          </div>
          <div class="flex items-center justify-between">
            <span class="text-slate-600">Antrian Offline</span>
            <span id="queueCount" class="inline-flex items-center gap-1 rounded-lg bg-slate-100 px-2 py-0.5">0</span>
          </div>
          <div class="flex items-center justify-between">
            <span class="text-slate-600">Sinkronisasi</span>
            <span id="syncState" class="inline-flex items-center gap-1 rounded-lg bg-emerald-100 text-emerald-700 px-2 py-0.5">Siap</span>
          </div>
          <button id="exportCsv" class="mt-1 w-full text-left text-brand-700 hover:text-brand-800 hover:underline">Unduh antrian lokal (CSV)</button>
        </div>
      </div>
    </section>

    <!-- Tab: Generator -->
    <section id="tab-generate" class="hidden grid gap-6">
      <div class="bg-white rounded-2xl shadow-sm ring-1 ring-slate-200">
        <div class="p-4 border-b border-slate-100 flex items-center justify-between">
          <h2 class="font-semibold">Generator QR</h2>
        </div>
        <div class="p-4 grid md:grid-cols-2 gap-6">
          <div class="grid gap-3">
            <label class="text-sm text-slate-600">Isi QR</label>
            <textarea id="qrText" class="rounded-xl border-slate-200 focus:ring-brand-400 focus:border-brand-400 p-3 min-h-[120px]" placeholder="Masukkan isi QR (misal: ID karyawan)"></textarea>
            <button id="makeQR" class="mt-1 w-max inline-flex items-center gap-2 rounded-xl bg-brand-600 text-white px-4 py-2.5 font-medium hover:bg-brand-700">Buat QR</button>
          </div>
          <div class="grid place-items-center">
            <div id="qrCanvasWrap" class="w-56 h-56 bg-white rounded-2xl ring-1 ring-slate-200 grid place-items-center">
              <canvas id="qrCanvas" class="max-w-full max-h-full"></canvas>
            </div>
            <button id="downloadQR" class="mt-3 text-sm text-brand-700 hover:underline">Unduh PNG</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Tab: Admin & Rekap -->
    <section id="tab-admin" class="hidden grid gap-6">
      <div class="bg-white rounded-2xl shadow-sm ring-1 ring-slate-200">
        <div class="p-4 border-b border-slate-100 flex items-center justify-between">
          <h2 class="font-semibold">Dashboard</h2>
          <div class="flex items-center gap-2">
            <input id="filterDate" type="date" class="text-sm rounded-lg border-slate-200 focus:ring-brand-400 focus:border-brand-400" />
            <select id="filterEmployee" class="text-sm rounded-lg border-slate-200 focus:ring-brand-400 focus:border-brand-400 min-w-40">
              <option value="">Semua Karyawan</option>
            </select>
            <button id="refreshRecap" class="text-sm px-3 py-1.5 rounded-lg bg-slate-100 hover:bg-slate-200">Refresh</button>
          </div>
        </div>
        <div class="p-4">
          <!-- Mini stats -->
          <div class="grid sm:grid-cols-3 gap-4">
            <div class="rounded-2xl ring-1 ring-slate-200 p-4 bg-gradient-to-br from-brand-50 to-white">
              <p class="text-xs text-slate-500">Total IN</p>
              <p id="statIn" class="text-2xl font-bold">0</p>
            </div>
            <div class="rounded-2xl ring-1 ring-slate-200 p-4">
              <p class="text-xs text-slate-500">Total OUT</p>
              <p id="statOut" class="text-2xl font-bold">0</p>
            </div>
            <div class="rounded-2xl ring-1 ring-slate-200 p-4">
              <p class="text-xs text-slate-500">Telat</p>
              <p id="statLate" class="text-2xl font-bold">0</p>
            </div>
          </div>

          <!-- Table -->
          <div class="mt-6 overflow-x-auto">
            <table class="min-w-full text-sm">
              <thead>
                <tr class="text-left text-slate-600">
                  <th class="py-2 px-3">Tanggal</th>
                  <th class="py-2 px-3">Karyawan</th>
                  <th class="py-2 px-3">IN</th>
                  <th class="py-2 px-3">OUT</th>
                  <th class="py-2 px-3">Keterangan</th>
                </tr>
              </thead>
              <tbody id="logTable" class="align-top divide-y divide-slate-100"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Toast -->
  <div id="toast" class="pointer-events-none fixed inset-x-0 top-3 grid place-items-center px-3">
    <div class="hidden max-w-md w-full rounded-xl bg-white ring-1 ring-slate-200 shadow-soft px-4 py-3 text-sm" role="status"></div>
  </div>

  <!-- Simple JS glue (UI only; keep existing app logic in script.js) -->
  <script>
    const $ = (s, r=document) => r.querySelector(s);
    const $$ = (s, r=document) => [...r.querySelectorAll(s)];

    // Tabs
    $$('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        $$('.tab-btn').forEach(b => b.classList.remove('active','bg-brand-600','text-white'));
        btn.classList.add('active','bg-brand-600','text-white');
        const tab = btn.dataset.tab;
        ['scan','generate','admin'].forEach(name => {
          const el = $('#tab-' + name);
          el.classList.toggle('hidden', name !== tab);
        });
      });
    });

    // Clock
    const clockEl = $('#clock');
    const tick = () => {
      const d = new Date();
      const pad = (n) => String(n).padStart(2,'0');
      clockEl.textContent = `${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
      requestAnimationFrame(() => setTimeout(tick, 1000));
    };
    tick();

    // Theme toggle (class-based dark mode)
    const themeBtn = $('#btnTheme');
    themeBtn.addEventListener('click', () => {
      const root = document.documentElement;
      const isDark = root.classList.toggle('dark');
      document.body.classList.toggle('bg-slate-900', isDark);
      document.body.classList.toggle('text-slate-100', isDark);
      themeBtn.textContent = isDark ? '☀️ Mode' : '🌙 Mode';
    });

    // Toast helper
    function showToast(msg, { ok=true, ms=2000 }={}) {
      const box = $('#toast > div');
      box.classList.remove('hidden');
      box.innerHTML = `<div class="flex items-start gap-2">
          <div class="mt-0.5">${ok ? '✅' : '⚠️'}</div>
          <div>${msg}</div>
        </div>`;
      setTimeout(() => box.classList.add('hidden'), ms);
    }

    // Wire some demo actions to existing IDs (the real logic should live in your current script.js)
    $('#scanButton')?.addEventListener('click', () => showToast('Memulai pemindaian…'));
    $('#sendNow')?.addEventListener('click', () => showToast('Mengirim antrian sekarang…'));
    $('#exportCsv')?.addEventListener('click', () => showToast('Menyiapkan ekspor CSV…'));
    $('#makeQR')?.addEventListener('click', () => showToast('Membuat QR…'));

    // Maintain backward-compatible hooks for existing code
    // - qrVideo, scanButton, sendNow, logTable, statusBadge, etc. are kept as IDs.
  </script>
  <!--
    Integrasi:
    1) Simpan file ini sebagai index.html dan letakkan berdampingan dengan script.js lama Anda.
    2) Pastikan script.js Anda tetap memilih elemen berdasarkan ID yang sama (qrVideo, scanButton, sendNow, dll).
    3) Hapus stylesheet lama (CSS custom) jika ada, karena Tailwind sudah mengatur tampilan.
    4) Sesuaikan logo di /logo.png dan favicon sesuai branding AerynSalon.
    5) Jika ingin build produksi tanpa CDN, pasang Tailwind CLI lalu proses file ini.
  -->
</body>
</html>
